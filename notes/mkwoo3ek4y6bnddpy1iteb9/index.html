<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Terraform</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Wiki / Digital Garden"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="zoobhalu"/><meta name="twitter:creator" content="zoobhalu"/><meta property="og:title" content="Terraform"/><meta property="og:description" content="Personal Wiki / Digital Garden"/><meta property="og:url" content="localhost:3000/notes/mkwoo3ek4y6bnddpy1iteb9/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/24/2022"/><meta property="article:modified_time" content="7/18/2022"/><link rel="canonical" href="localhost:3000/notes/mkwoo3ek4y6bnddpy1iteb9/"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/cc2307f6fd3a2fec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cc2307f6fd3a2fec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-709abf7ab5f510de.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-c4b0e551a2150d17.js" defer=""></script><script src="/_next/static/chunks/pages/_app-62c5b93605efada7.js" defer=""></script><script src="/_next/static/chunks/78-13ae6acd5ce7ca5b.js" defer=""></script><script src="/_next/static/chunks/373-2f3879190a46a3d9.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-69449972c2a725d8.js" defer=""></script><script src="/_next/static/4oDSInv8WeDX6cVSprjyl/_buildManifest.js" defer=""></script><script src="/_next/static/4oDSInv8WeDX6cVSprjyl/_ssgManifest.js" defer=""></script><script src="/_next/static/4oDSInv8WeDX6cVSprjyl/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="terraform"><a aria-hidden="true" class="anchor-heading" href="#terraform"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Terraform</h1>
<p>Terraform is an open source infrastructure as code (<a href="/notes/ogswllwu9h5oqeiteyhrtd6">IaC</a>) software tool that allows DevOps engineers to programmatically provision the physical resources an application requires to run. To create and configure infrastructure . NOT for installing stuff on the server, just for provisioning.</p>
<p>It is a universal <a href="/notes/ogswllwu9h5oqeiteyhrtd6">IaC</a> tool, works with different cloud providers and technologies.</p>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">IaC</span></div>
<a href="/notes/ogswllwu9h5oqeiteyhrtd6" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>Infrastructure as code is an IT practice that manages an application's underlying IT infrastructure through programming. This approach to resource allocation allows developers to logically manage, monitor and provision resources -- as opposed to requiring that an operations team manually configure each required resource.</p>
<p>Managing infrastructure (servers, network, etc) through definition files rather than manual configuration. Much like <a href="/notes/xuy2qlaaas5gxkbjpuierrr">Configuration Management</a>, this enables automation, consistency, and is self-documenting.</p>
</div></div><p></p><p></p>
<p>It uses declarative syntax(as opposed to imperative syntax) to define what the end result looks like and it will figure out how to provision the infrastructure.</p>
<ul>
<li>It is also helps in automating the infrastructure as it changes over time.</li>
<li>To replicate the same infrastructure in different environments(Dev, Staging, Production)</li>
</ul>
<p>Using Terraform, your infrastructure is idempotent. You don't need to remember the current state, you only define your desired state. Since, you use declarative syntax, you don't define the steps like you would if you were using imperative syntax.</p>
<h2 id="ansible-vs-terraform"><a aria-hidden="true" class="anchor-heading" href="#ansible-vs-terraform"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a><a href="/notes/mwyyxjbpi0gztjd00f39biv">Ansible</a> VS Terraform</h2>
<ul>
<li>Terraform is mainly an infrastructure provisioning tool.</li>
<li>Ansible is mainly used for configuring infrastructure.</li>
<li>Its a common practice to combine both to get the best of both.</li>
</ul>
<h2 id="terraform-architecture"><a aria-hidden="true" class="anchor-heading" href="#terraform-architecture"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Terraform Architecture</h2>
<p>It has 2 components:</p>
<h3 id="core"><a aria-hidden="true" class="anchor-heading" href="#core"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Core</h3>
<ul>
<li>Takes 2 input sources
<ul>
<li>Terraform Config</li>
<li>State(current state of the infrastructure)</li>
</ul>
</li>
<li>Core takes the input from the config and state and compares what needs to be changed and what is already there as per the config and state.</li>
<li>It essentially <strong>creates the execution plan</strong> that the providers use.</li>
</ul>
<h3 id="providers"><a aria-hidden="true" class="anchor-heading" href="#providers"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Providers</h3>
<ul>
<li>This can be providers for the specifc technology(AWS, GCP, Azure, OpenStack, other <a href="/notes/au5c3uq0jd84a2tg9oe25ll">IaaS</a>)</li>
<li>It can also has providers for higher level technologies(<a href="/notes/gbeh61d6hvbmxxy63chp81b">Kubernetes</a>, other <a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">devlog.PaaS (Private)</a> or even <a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">devlog.SaaS (Private)</a>)</li>
<li>It has over 100 providers and over 1000 resources.</li>
</ul>
<h2 id="example-config-files"><a aria-hidden="true" class="anchor-heading" href="#example-config-files"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Example config files</h2>
<p><img src="https://res.cloudinary.com/zubayr/image/upload/v1655346903/wiki/lazrvzt8omhhkplp3xwt.png"></p>
<p><img src="https://res.cloudinary.com/zubayr/image/upload/v1655346973/wiki/tcxkbpv4dyrx9yjtnufu.png"></p>
<p>We only define a few attributes in the configuration file, the rest or defaults are handled by terraform. Auto-generated.</p>
<h2 id="terraform-commands-for-different-stages"><a aria-hidden="true" class="anchor-heading" href="#terraform-commands-for-different-stages"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Terraform commands for different stages</h2>
<ul>
<li><code>refresh</code> - query infra provider to get current state.</li>
<li><code>plan</code> - create an execution plan, just preview no real changes.</li>
<li><code>apply</code> - executes the plan(it does all the above steps, like refresh and plan and then apply).</li>
<li><code>destroy</code> - destroys the resources/infrastructure in the right order, does cleaning up of the resources. Reverting. It works similar to <code>apply</code>, it checks the state and makes a plan for what needs to be done.</li>
</ul>
<h2 id="providers-1"><a aria-hidden="true" class="anchor-heading" href="#providers-1"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Providers</h2>
<ul>
<li>They're basically a piece of code that knows how to talk to a specific technology. To connect to it and start using. Interact.</li>
<li>Expose resources for specific technology(AWS, GCP, Azure, OpenStack, other <a href="/notes/au5c3uq0jd84a2tg9oe25ll">IaaS</a>)</li>
<li>Responsible for understanding API of that platform.</li>
<li><a href="https://registry.terraform.io/browse/providers">Browse Providers | Terraform Registry</a></li>
<li>Providers don't come with installation of terraform, they need to be installed separately.</li>
<li>Once provider is installed using the <code>terraform init</code> command, the complete API of that provider is available.</li>
<li>You get 2 components from the Providers
<ul>
<li>Resources</li>
<li>Data Sources</li>
</ul>
</li>
</ul>
<h2 id="resources"><a aria-hidden="true" class="anchor-heading" href="#resources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Resources</h2>
<ul>
<li>You can use the <code>resource</code> keyword in your <code>.tf</code> file using the resource's name.</li>
<li>The name of a resource follows the convention of <code>&#x3C;provider>_&#x3C;resource></code>.</li>
<li>You can assign the resource to a variable by providing a variable name right after the resource name.</li>
<li>Each resource block describes one or more infrastructure objects. As referred to as "attributes" or "parameters".</li>
<li>When you're creating a resource for another resource that doesn't yet exist, you can reference the object.</li>
</ul>
<h2 id="data-sources"><a aria-hidden="true" class="anchor-heading" href="#data-sources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Data Sources</h2>
<ul>
<li>Allows data to be fetched for use in the <code>.tf</code> files.</li>
<li>Query existing resources/components.</li>
<li>It follows the same convention as the resource names.</li>
</ul>
<h2 id="terraform-commands"><a aria-hidden="true" class="anchor-heading" href="#terraform-commands"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Terraform Commands</h2>
<ul>
<li><code>terraform init</code> - initialize the working directory. Installs the providers defined in the config file.</li>
<li><code>terraform apply</code> - apply the changes using the configuration file in the working directory.</li>
<li><code>terraform apply -auto-approve</code> - to skip the approve prompt.</li>
<li><code>terraform destroy</code> - if <code>-target</code> is not specified, it'll destroy all of the resources defined in the configuration file.</li>
</ul>
<h2 id="examples"><a aria-hidden="true" class="anchor-heading" href="#examples"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Examples</h2>
<h3 id="creating-an-ec2-instance-with-terraform"><a aria-hidden="true" class="anchor-heading" href="#creating-an-ec2-instance-with-terraform"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Creating an EC2 instance with Terraform</h3>
<pre class="language-json"><code class="language-json">provider <span class="token string">"aws"</span> <span class="token punctuation">{</span>
  region = <span class="token string">"us-east-1"</span>
  access_key = <span class="token string">"AKIAJX7X7X7X7X7X7X7X"</span>
  secret_key = <span class="token string">"secret"</span>
  <span class="token comment">// don't hard code the above values use Environment variables</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_vpc"</span> <span class="token string">"test_vpc"</span> <span class="token punctuation">{</span>
  cidr_block = <span class="token string">"10.0.0.0/16"</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_subnet"</span> <span class="token string">"test-subnet-1"</span> <span class="token punctuation">{</span>
  vpc_id = aws_vpc.test_vpc.id
  cidr_block = <span class="token string">"10.0.10.0/24"</span>
  availability_zone = <span class="token string">"us-east-1a"</span>
<span class="token punctuation">}</span>

<span class="token comment">// if you wanted to create a subnet for an existing vpc, you could hard code the ID of your vpc OR use data sources</span>

data <span class="token string">"aws_vpc"</span> <span class="token string">"existing_vpc"</span> <span class="token punctuation">{</span>
  <span class="token comment">//  use filter or attributes to filter through of your existing vpc/resource</span>
  default = <span class="token boolean">true</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_subnet"</span> <span class="token string">"test-subnet-2"</span> <span class="token punctuation">{</span>
  vpc_id = data.existing_vpc.id
  cidr_block = <span class="token string">"172.31.48.0/20"</span>
  availability_zone = <span class="token string">"us-east-1a"</span>
</code></pre>
<h3 id="changing-resources"><a aria-hidden="true" class="anchor-heading" href="#changing-resources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Changing resources</h3>
<p>Adding names using <code>tags:</code> keyword and using the reserved <code>Name</code> attribute for defining a name.
To remove something, you'd simply remove it from the config file.</p>
<pre class="language-json"><code class="language-json">provider <span class="token string">"aws"</span> <span class="token punctuation">{</span>
  region = <span class="token string">"us-east-1"</span>
  access_key = <span class="token string">"AKIAJX7X7X7X7X7X7X7X"</span>
  secret_key = <span class="token string">"secret"</span>
  <span class="token comment">// don't hard code the above values</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_vpc"</span> <span class="token string">"test_vpc"</span> <span class="token punctuation">{</span>
  cidr_block = <span class="token string">"10.0.0.0/16"</span>
  tags = <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> <span class="token string">"development-vpc"</span><span class="token punctuation">,</span>
    vpc_env<span class="token operator">:</span> <span class="token string">"dev"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_subnet"</span> <span class="token string">"test-subnet-1"</span> <span class="token punctuation">{</span>
  vpc_id = aws_vpc.test_vpc.id
  cidr_block = <span class="token string">"10.0.10.0/24"</span>
  availability_zone = <span class="token string">"us-east-1a"</span>
    tags = <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> <span class="token string">"development-subnet"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// if you wanted to create a subnet for an existing vpc, you could hard code the ID of your vpc OR use data sources</span>

data <span class="token string">"aws_vpc"</span> <span class="token string">"existing_vpc"</span> <span class="token punctuation">{</span>
  <span class="token comment">//  use filter or attributes to filter through of your existing vpc/resource</span>
  default = <span class="token boolean">true</span>
<span class="token punctuation">}</span>

resource <span class="token string">"aws_subnet"</span> <span class="token string">"test-subnet-2"</span> <span class="token punctuation">{</span>
  vpc_id = data.existing_vpc.id
  cidr_block = <span class="token string">"172.31.48.0/20"</span>
  availability_zone = <span class="token string">"us-east-1a"</span>
</code></pre>
<h3 id="removingdestroying-resources"><a aria-hidden="true" class="anchor-heading" href="#removingdestroying-resources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Removing/Destroying resources</h3>
<ol>
<li>Remove the resource from Terraform config file and <code>terraform apply</code>. (Recommended)</li>
<li><code>terraform destroy -target resource_type.resource_name</code></li>
</ol>
<h2 id="state"><a aria-hidden="true" class="anchor-heading" href="#state"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>State</h2>
<p><code>terraform.tfstate</code> - it is a <code>json</code> file where Terraform stores the state of your managed infrastructure. It generates this file on your first <code>terraform apply</code>.</p>
<p><code>terraform.tfstate.backup</code> is the file that is created to store the backup of the previous state.</p>
<p>Neither of these files should be updated manually and must be updated as a result of executing <code>terraform</code> commands.</p>
<p>Terraform has commands to access the information in the state file.</p>
<ul>
<li><code>terraform state</code> - list all subcommands of <code>state</code>.</li>
<li><code>terraform state list</code> - list all resources in the state.</li>
<li><code>terraform state mv</code> - move an item in the state.</li>
<li><code>terraform state show</code> - show a resource in the state. Useful for checking the values of the attributes that were autogenerated by Terraform.</li>
</ul>
<h2 id="output"><a aria-hidden="true" class="anchor-heading" href="#output"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Output</h2>
<p>We can define what value we want Terraform to spit at the end of applying of the configuration from the resources. Output values are like function's return values.</p>
<pre class="language-json"><code class="language-json">output <span class="token string">"dev-vpc-id"</span> <span class="token punctuation">{</span>
  value = aws_vpc.development_vpc.id
<span class="token punctuation">}</span>

output <span class="token string">"dev-subnet-id"</span> <span class="token punctuation">{</span>
  value = aws_subnet.dev-subnet<span class="token number">-1</span>.id
<span class="token punctuation">}</span>
</code></pre>
<h2 id="variables"><a aria-hidden="true" class="anchor-heading" href="#variables"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Variables</h2>
<p>You use variables inside of the configuration file. variables = input variables. If you don't want to hard code values you can pass them as parameters. Define and reference it. Input variables are like function arguments. They're defined using <code>variable</code> keyword. Makes it easier to replicate, parameterize, and reuse the same configuration over different environments. You'd have different <code>.tfvars</code> files for different environments.</p>
<pre class="language-json"><code class="language-json">variable <span class="token string">"subnet_cidr_block"</span> <span class="token punctuation">{</span>
  description = <span class="token string">"CIDR block for the subnet"</span>
  default = <span class="token string">"10.0.30.0/24"</span>
  type = string
<span class="token punctuation">}</span>

resource <span class="token string">"aws_vpc"</span> <span class="token string">"development_vpc"</span> <span class="token punctuation">{</span>
  vpc_id = aws_vpc.test_vpc.id
  cidr_block = var.subnet_cidr_block
  availability_zone = <span class="token string">"us-east-1a"</span>
  tags<span class="token operator">:</span> <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> <span class="token string">"subnet-1-dev"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>There are three ways to pass values to input variables.</p>
<ol>
<li>Prompt when <code>terraform apply</code> is run.</li>
<li>Define the value when running apply command
<ul>
<li><code>terraform apply -var "subnet_cidr_block=10.0.30.0/24</code></li>
</ul>
</li>
<li>Use a <code>.tfvars</code> to pass the values from a file. (Recommended)
<ul>
<li><code>terraform.tfvars</code> - this is a file that contains the (keys)values for the variables. (If you don't pass a file name, it'll look for this file)</li>
<li>Use the <code>-var-file</code> flag to pass the file name.
<ul>
<li><code>terraform apply -var-file terraform-dev.tfvars</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="default-values"><a aria-hidden="true" class="anchor-heading" href="#default-values"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Default values</h3>
<p>Default value will kick in if terraform cannot find the value in the <code>.tfvars</code> file or as a command line argument. A default value makes the variable optional.</p>
<h3 id="type-constraints"><a aria-hidden="true" class="anchor-heading" href="#type-constraints"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Type constraints</h3>
<p><code>type</code> specifies what value types the variable can accept.</p>
<p>Using <code>list</code>:</p>
<pre class="language-json"><code class="language-json">variable <span class="token string">"cidr_blocks"</span> <span class="token punctuation">{</span>
  description = <span class="token string">"CIDR blocks list"</span>
  type = list(string)
<span class="token punctuation">}</span>

resource <span class="token string">"aws_subnut"</span> <span class="token string">"dev-subnet-1"</span> <span class="token punctuation">{</span>
  vpc_id = aws_vpc.test_vpc.id
  cidr_block = var.cidr_blocks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  availability_zone = <span class="token string">"us-east-1a"</span>
  tags<span class="token operator">:</span> <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> <span class="token string">"subnet-1-dev"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You can also use objects or lists of objects. You can also validate the type of the value for the objects as well.</p>
<pre class="language-json"><code class="language-json"><span class="token comment">// terraform-dev.tfvars</span>

cidr_blocks = <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>cidr_block = <span class="token string">"10.0.10.0/16"</span><span class="token punctuation">,</span> name = <span class="token string">"dev_vpc"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>cidr_block = <span class="token string">"10.0.20.0/24, name = "</span>dev_subnet"<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
<pre class="language-json"><code class="language-json">variable <span class="token string">"cidr_blocks"</span> <span class="token punctuation">{</span>
  description = <span class="token string">"CIDR blocks list and Name tag"</span>
  type = list(object(<span class="token punctuation">{</span>
    cidr_block<span class="token operator">:</span> string
    name<span class="token operator">:</span> string
  <span class="token punctuation">}</span>))
<span class="token punctuation">}</span>

resource <span class="token string">"aws_vpc"</span> <span class="token string">"test_vpc"</span> <span class="token punctuation">{</span>
  cidr_block = var.cidr_blocks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.cidr_block
  tags = <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> var.cidr_blocks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="environment-variables"><a aria-hidden="true" class="anchor-heading" href="#environment-variables"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Environment Variables</h2>
<p>Environment variables are defined by the providers for you to use.</p>
<ol>
<li>
<p>Use <code>export</code> to set the environment variable, it will be available only for the current shell session.</p>
<p><code>export AWS_SECRET_ACCESS_KEY=&#x3C;secret_access_key></code>
<code>export AWS_ACCESS_KEY_ID=&#x3C;access_key_id></code></p>
</li>
<li>
<p>Set the environment variable in the <code>~/.aws/credentials</code> to be available globally, you may also use <code>aws configure</code> to set the credentials.</p>
</li>
</ol>
<h3 id="tf-environment-variable"><a aria-hidden="true" class="anchor-heading" href="#tf-environment-variable"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>TF Environment Variable</h3>
<p>Define your own custom variables and use <code>.tf_var</code> to pass them to the Terraform configuration as global environment variables.</p>
<ul>
<li>Define the variable - <code>export TF_VAR_my_custom_variable="my_custom_value"</code></li>
<li>To use it, reference it without the <code>TF_VAR_</code> prefix.</li>
</ul>
<pre class="language-json"><code class="language-json">variable <span class="token string">"my_custom_variable"</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

resource <span class="token string">"aws_subnut"</span> <span class="token string">"dev-subnet-1"</span> <span class="token punctuation">{</span>
  vpc_id = aws_vpc.test_vpc.id
  cidr_block = var.cidr_blocks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  availability_zone = var.my_custom_variable
  tags<span class="token operator">:</span> <span class="token punctuation">{</span>
    Name<span class="token operator">:</span> <span class="token string">"subnet-1-dev"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Terraform in AWS</span></div>
<a href="/notes/bhvn90wgxfjtejvv2t10lvx" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>In this lab, we'll do:</p>
<ul>
<li>Provision an <a href="/notes/1h5mmmv2b68di6siwa31jvh">AWS EC2</a> instance on AWS.</li>
<li>Run a simple <a href="/notes/7jdwsm0maamijwmsnzebbwf">Nginx</a> <a href="/notes/wf37vjntme0oklsx52ycrn4">Docker</a> container on it.</li>
<li>We'll do this on AWS infrastructure using Terraform (obviously).</li>
</ul>
<h2 id="steps"><a aria-hidden="true" class="anchor-heading" href="#steps"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Steps</h2>
<ol>
<li>Create custom VPC</li>
<li>Create custom Subnet</li>
<li>Create Route table and Internet Gateway.
<ul>
<li>To connect the VPC to the internet.</li>
<li>Allow traffic to and from VPC.</li>
</ul>
</li>
<li>Deploy EC2 instance on the Subnet.</li>
<li>Deploy ngnix Docker container.</li>
<li>Create Security Group(Firewall), opening ports.
<ul>
<li>In order to access the Web Application.</li>
<li>And also to SSH into that EC2 server.</li>
</ul>
</li>
</ol>
<h2 id="create-vpc-and-subnet"><a aria-hidden="true" class="anchor-heading" href="#create-vpc-and-subnet"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Create VPC and Subnet</h2>
<pre class="language-terraform"><code class="language-terraform">provider "aws" {
  region = "eu-central-1"
}

variable vpc_cidr_block {}
variable subnet_1_cidr_block {}
variable avail_zone {}
variable env_prefix {}
variable instance_type {}
variable ssh_key {}
variable my_ip {}

data "aws_ami" "amazon-linux-image" {
  most_recent = true
  owners      = ["amazon"]

  filter {
    name   = "name"
    values = ["amzn2-ami-hvm-*-x86_64-gp2"]
  }

  filter {
    name   = "virtualization-type"
    values = ["hvm"]
  }
}

output "ami_id" {
  value = data.aws_ami.amazon-linux-image.id
}

resource "aws_vpc" "myapp-vpc" {
  cidr_block = var.vpc_cidr_block
  tags = {
      Name = "${var.env_prefix}-vpc"
  }

  # Route table is auto-generated for your VPC by AWS
  # Default Network ACL - firewall configuration (applied to subnet in that VPC)
}

resource "aws_subnet" "myapp-subnet-1" {
  vpc_id = aws_vpc.myapp-vpc.id
  cidr_block = var.subnet_1_cidr_block
  availability_zone = var.avail_zone
  tags = {
      Name = "${var.env_prefix}-subnet-1"
  }
}

resource "aws_security_group" "myapp-sg" {
# BTW you can also just use the default SG that was generated when VPC was created
# resource "aws_default_security_group" "default-sg" { # you really only need to change this, rest remains the same
  name   = "myapp-sg"
  vpc_id = aws_vpc.myapp-vpc.id

# Defining traffic rules for firewall
  ingress {
    from_port   = 22
    to_port     = 22 # you can even set a range of ports but we only need 22
    protocol    = "tcp"
    cidr_blocks = [var.my_ip]
  }

  ingress {
    from_port   = 8080
    to_port     = 8080
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    # allow any traffic to leave server
    from_port       = 0
    to_port         = 0
    protocol        = "-1" # any protocols
    cidr_blocks     = ["0.0.0.0/0"]
    prefix_list_ids = []
  }

  tags = {
    Name = "${var.env_prefix}-sg"
  }
}

resource "aws_internet_gateway" "myapp-igw" {
	vpc_id = aws_vpc.myapp-vpc.id

    # Think of it as a virtual modem
    # Even though it has to be created before Route table, you don't necessarily have to put this block before the route table block.
    # Terraform knows in which sequence it needs to create components.
    tags = {
     Name = "${var.env_prefix}-internet-gateway"
   }
}

resource "aws_route_table" "myapp-route-table" {
   vpc_id = aws_vpc.myapp-vpc.id

    # Think of it as a virtual router inside your VPC
    # Create a new Route table as it is a best practice(not going with the default that comes with VPC creation)
    # default route, mapping VPC CIDR block to "local", created implicitly and cannot be specified.
   route {
     cidr_block = "0.0.0.0/0"
     gateway_id = aws_internet_gateway.myapp-igw.id
   }

   # Route table basically routes traffic within your VPC  (local)
   # You have to add an Internet Gateway to connect your VPC to the internet
   # Check "routes" in your Route Table for 0.0.0.0/0 (destination) and there has to be an Internet Gateway(as target)

   tags = {
     Name = "${var.env_prefix}-route-table"
   }
 }

# Associate subnet with Route Table
# All the resource that will be deployed in the subnet, all the traffic will be handled by the route table once the association has been made.
resource "aws_route_table_association" "a-rtb-subnet" {
  subnet_id      = aws_subnet.myapp-subnet-1.id
  route_table_id = aws_route_table.myapp-route-table.id
}

# To use the default route table instead of creating a new one

# resource "aws_default_route_table" "main-rtb" {
#   # get default route table id by terraform state show aws_vpc.myapp-vpc(it has to exist) to list all attribute it has
#   default_route_table_id = aws_vpc.myapp-vpc.default_route_table_id
#   route {
#      cidr_block = "0.0.0.0/0"
#      gateway_id = aws_internet_gateway.myapp-igw.id
#    }

#   tags = {
#      Name = "${var.env_prefix}-main-rtb"
#    }

# In this case, you don't need to add subnet association as "main" route tables as default subnet gets auto-assigned
# }


# automated key generation
resource "aws_key_pair" "ssh-key" {
  key_name   = "myapp-key"
  # public_key = var.my_public_key
  public_key = file(var.ssh_key) # this should exist locally - you should create it yourself.
}

output "server-ip" {
    value = aws_instance.myapp-server.public_ip
}

resource "aws_instance" "myapp-server" {
  # required
  ami                         = data.aws_ami.amazon-linux-image.id
  instance_type               = var.instance_type

  # create a public-private key sshing into the EC2 instance, don't forget to `chmod 400 ~/.ssh/.pem` after moving it to `~/.ssh` - this applies only when you manually create it

  key_name                    = "myapp-key"

  # optional
  associate_public_ip_address = true
  subnet_id                   = aws_subnet.myapp-subnet-1.id
  vpc_security_group_ids      = [aws_security_group.myapp-sg.id]
  availability_zone			      = var.avail_zone

  tags = {
    Name = "${var.env_prefix}-server"
  }

  user_data = &#x3C;&#x3C;EOF
                 #!/bin/bash
                 apt-get update &#x26;&#x26; apt-get install -y docker-ce
                 systemctl start docker
                 usermod -aG docker ec2-user
                 docker run -p 8080:8080 nginx
              EOF
}

resource "aws_instance" "myapp-server-two" {
  ami                         = data.aws_ami.amazon-linux-image.id
  instance_type               = var.instance_type
  key_name                    = "myapp-key"
  associate_public_ip_address = true
  subnet_id                   = aws_subnet.myapp-subnet-1.id
  vpc_security_group_ids      = [aws_security_group.myapp-sg.id]
  availability_zone			      = var.avail_zone

  tags = {
    Name = "${var.env_prefix}-server-two"
  }

  # you can refer a bash file instead of writing it here

  # doing the below changes will cause your EC2 instance to replaced(destroy and create)
  # user_data = file("entry-script.sh") # this file has to be located in your terraform dir
  # Ideally, Terraform should only be used for initial infra setup/management, but for setting up applications and servers, you should probably use something like Ansible or Chef.
  user_data = &#x3C;&#x3C;EOF
                 #!/bin/bash
                 apt-get update &#x26;&#x26; apt-get install -y docker-ce
                 systemctl start docker
                 usermod -aG docker ec2-user
                 docker run -p 8080:8080 nginx
              EOF
}
</code></pre></div></div><p></p><p></p>
<h2 id="provisioners"><a aria-hidden="true" class="anchor-heading" href="#provisioners"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Provisioners</h2>
<p>Provisioners can be used to model specific actions on the local machine running the Terraform Core or on a remote machine to prepare servers or other infrastructure objects. But HashiCorp states in its documentation that they should be used as the last solution!</p>
<h3 id="null-resource"><a aria-hidden="true" class="anchor-heading" href="#null-resource"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Null resource</h3>
<p>From the Terraform docs:</p>
<p>The null provider is a rather-unusual provider that has constructs that intentionally do nothing. This may sound strange, and indeed these constructs do not need to be used in most cases, but they can be useful in various situations to help orchestrate tricky behavior or work around limitations.</p>
<p>The documentation of each feature of this provider, accessible via the navigation, gives examples of situations where these constructs may prove useful.</p>
<p>Usage of the null provider can make a Terraform configuration harder to understand. While it can be useful in certain cases, it should be applied with care and other solutions preferred when available.</p>
<p>The Terraform null_resourceis commonly used to run scripts on a specified trigger.</p>
<h3 id="connection-attribute"><a aria-hidden="true" class="anchor-heading" href="#connection-attribute"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Connection attribute</h3>
<p><code>remote-exec</code> provisioners require connection credentials to function, even though <code>remote-exec</code> might be defined in a resource block that is a server, it doesn't connect to it unless explicity defined.</p>
<h3 id="remote-exec-provisioner"><a aria-hidden="true" class="anchor-heading" href="#remote-exec-provisioner"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a><code>remote-exec</code> provisioner</h3>
<p>This provisioner invokes a script on the newly created resource. it’s similar to connecting to the resource and running a bash or a command in the terminal.</p>
<p>It can be used inside the Terraform resource object and in that case it will be invoked once the resource is created, or it can be used inside a null resource which is my prefered approche as it separates this non terraform behavior from the real terraform behavior.</p>
<ul>
<li>Invokes script on a remote resource after it is created
<ul>
<li><code>inline</code> - list of commands</li>
<li><code>script</code> - path to script</li>
</ul>
</li>
</ul>
<pre class="language-terraform"><code class="language-terraform">resource "null_resource" "configure-vm" {

  connection {
      type = "ssh"
      user = var.username
      host = var.ip_address
      private_key = var.tls_private_key
    }

  ## Copy files to VM :
  provisioner "file" {
    source = "/Users/zakariaelbazi/Documents/GitHub/zackk8s/kubernetes" #TODO move to variables.
    destination = "/home/${var.username}"
  }

  ## install &#x26; start minikube
  provisioner "remote-exec" {
    inline = [
      "sudo chmod +x /home/${var.username}/kubernetes/install_minikube.sh",
      "sh /home/${var.username}/kubernetes/install_minikube.sh",
      "./minikube start --driver=docker"
    ]
  }
}
</code></pre>
<blockquote>
<p>Note that you can not pass any arguments to the script or command, so the best way is to use file provisioner to copy the files to the resources and then invoke them with the remote-exec provisioner like I did above for my script that installs minikube on the azure-vm.</p>
</blockquote>
<blockquote>
<p>An other thing to pay attention to is that by default, provisioners that fail will also cause the Terraform apply to fail. To avoid that, the on_failure can be used.</p>
</blockquote>
<pre class="language-terraform"><code class="language-terraform">resource "null_resource" "configure-vm" {
    .........
    ..........

  provisioner "remote-exec" {
    inline = [
      "sudo chmod +x /home/${var.username}/kubernetes/install_minikube.sh",
      "sh /home/${var.username}/kubernetes/install_minikube.sh",
      "./minikube start --driver=docker"
    ]
    on_failure = continue #or fail

  }
}
</code></pre>
<p>In this example, I am using inline which is a series of command, the on_failure will apply only to the final command in the list !</p>
<h3 id="local-exec-provisioner"><a aria-hidden="true" class="anchor-heading" href="#local-exec-provisioner"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a><code>local-exec</code> provisioner</h3>
<p>Technically, this one is very similar to the one before in terms of behavior or use but it works in the local machine ruining Terraform. It invokes a script or a command on local once the resource it’s declared in is created.</p>
<p>It’s the only provisioner that doesn’t need any ssh or winrm connection details as it runs locally.</p>
<h2 id="resources-1"><a aria-hidden="true" class="anchor-heading" href="#resources-1"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Resources</h2>
<ul>
<li><a href="https://jhooq.com/terraform-provisioner/">What is terraform provisioner? | Jhooq</a></li>
<li><a href="https://awstip.com/all-you-need-to-know-about-terraform-provisioners-and-why-you-should-avoid-them-22b5ef8d2db2">All you need to know about Terraform provisioners and why you should avoid them. | AWS Tip</a></li>
<li><a href="https://www.trendmicro.com/ru_ru/devops/22/c/terraform-tutorial-drift-detection-strategies.html">Terraform Tutorial: Drift Detection Strategies</a></li>
</ul>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/522ww47pqvt6y0yj8zparmy">DevOps</a></li>
<li><a href="/notes/kxbhnz5oxpmort5y94uvqc9">Packer</a></li>
<li><a href="/notes/e7pods321uz4fxgzzdhf002">Boto</a></li>
<li><a href="/notes/5eybx5vd339tjnkglx8igde">Devops Interview Questions</a></li>
<li><a href="/notes/i5wu7j4cvg8tzfyzkawbsjt">Ec2 Server Status Check using Boto3</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#devlogansible-vs-terraform" title="devlog.ansible VS Terraform">devlog.ansible VS Terraform</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#terraform-architecture" title="Terraform Architecture">Terraform Architecture</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#core" title="Core">Core</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#providers" title="Providers">Providers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#example-config-files" title="Example config files">Example config files</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#terraform-commands-for-different-stages" title="Terraform commands for different stages">Terraform commands for different stages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#providers-1" title="Providers">Providers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#resources" title="Resources">Resources</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#data-sources" title="Data Sources">Data Sources</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#terraform-commands" title="Terraform Commands">Terraform Commands</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#examples" title="Examples">Examples</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#creating-an-ec2-instance-with-terraform" title="Creating an EC2 instance with Terraform">Creating an EC2 instance with Terraform</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#changing-resources" title="Changing resources">Changing resources</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#removingdestroying-resources" title="Removing/Destroying resources">Removing/Destroying resources</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#state" title="State">State</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#output" title="Output">Output</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#variables" title="Variables">Variables</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#default-values" title="Default values">Default values</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#type-constraints" title="Type constraints">Type constraints</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#environment-variables" title="Environment Variables">Environment Variables</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tf-environment-variable" title="TF Environment Variable">TF Environment Variable</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#provisioners" title="Provisioners">Provisioners</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#null-resource" title="Null resource">Null resource</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#connection-attribute" title="Connection attribute">Connection attribute</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#remote-exec-provisioner" title="remote-exec provisioner">remote-exec provisioner</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#local-exec-provisioner" title="local-exec provisioner">local-exec provisioner</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#resources-1" title="Resources">Resources</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"mkwoo3ek4y6bnddpy1iteb9","title":"Terraform","desc":"","updated":1658154000010,"created":1653430082985,"custom":{},"fname":"devlog.terraform","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"5807fe7142d7f482ddaee1e706fae96a","links":[{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.IaC","alias":"devlog.IaC","position":{"start":{"line":2,"column":53,"offset":53},"end":{"line":2,"column":67,"offset":67},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.IaC"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.IaC","alias":"devlog.IaC","position":{"start":{"line":4,"column":19,"offset":320},"end":{"line":4,"column":33,"offset":334},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.IaC"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.ansible","alias":"devlog.ansible","position":{"start":{"line":15,"column":4,"offset":997},"end":{"line":15,"column":22,"offset":1015},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.ansible"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.IaaS","alias":"devlog.IaaS","position":{"start":{"line":35,"column":86,"offset":1678},"end":{"line":35,"column":101,"offset":1693},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.IaaS"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.kubernetes","alias":"devlog.kubernetes","position":{"start":{"line":36,"column":59,"offset":1753},"end":{"line":36,"column":80,"offset":1774},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.kubernetes"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.PaaS","alias":"devlog.PaaS","position":{"start":{"line":36,"column":88,"offset":1782},"end":{"line":36,"column":103,"offset":1797},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.PaaS"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.SaaS","alias":"devlog.SaaS","position":{"start":{"line":36,"column":112,"offset":1806},"end":{"line":36,"column":127,"offset":1821},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.SaaS"}},{"type":"wiki","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.IaaS","alias":"devlog.IaaS","position":{"start":{"line":57,"column":78,"offset":2913},"end":{"line":57,"column":93,"offset":2928},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"devlog.IaaS"}},{"type":"ref","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.IaC","position":{"start":{"line":6,"column":1,"offset":397},"end":{"line":6,"column":16,"offset":412},"indent":[]},"xvault":false,"to":{"fname":"devlog.IaC"}},{"type":"ref","from":{"fname":"devlog.terraform","id":"mkwoo3ek4y6bnddpy1iteb9","vaultName":"Dendron"},"value":"devlog.terraform aws","position":{"start":{"line":315,"column":1,"offset":10971},"end":{"line":315,"column":26,"offset":10996},"indent":[]},"xvault":false,"to":{"fname":"devlog.terraform aws"}},{"from":{"fname":"areas.devops","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":142,"column":5,"offset":4201},"end":{"line":142,"column":25,"offset":4221},"indent":[]},"value":"devlog.Terraform","alias":"devlog.Terraform"},{"from":{"fname":"devlog.Packer","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":2,"column":193,"offset":193},"end":{"line":2,"column":213,"offset":213},"indent":[]},"value":"devlog.Terraform","alias":"devlog.Terraform"},{"from":{"fname":"devlog.boto","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":10,"column":41,"offset":262},"end":{"line":10,"column":61,"offset":282},"indent":[]},"value":"devlog.terraform","alias":"devlog.terraform"},{"from":{"fname":"devlog.boto","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":79,"column":3,"offset":1910},"end":{"line":79,"column":23,"offset":1930},"indent":[]},"value":"devlog.terraform","alias":"devlog.terraform"},{"from":{"fname":"devlog.devops interview questions","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":269,"column":106,"offset":12259},"end":{"line":269,"column":126,"offset":12279},"indent":[]},"value":"devlog.terraform","alias":"devlog.terraform"},{"from":{"fname":"devlog.devops interview questions","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":368,"column":4,"offset":16740},"end":{"line":368,"column":24,"offset":16760},"indent":[]},"value":"devlog.terraform","alias":"devlog.terraform"},{"from":{"fname":"devlog.devops interview questions","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":458,"column":31,"offset":20740},"end":{"line":458,"column":51,"offset":20760},"indent":[]},"value":"devlog.Terraform","alias":"devlog.Terraform"},{"from":{"fname":"devlog.ec2 server status check","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":8,"column":60,"offset":126},"end":{"line":8,"column":80,"offset":146},"indent":[]},"value":"devlog.Terraform","alias":"devlog.Terraform"}],"anchors":{"devlogansible-vs-terraform":{"type":"header","text":"devlog.ansible VS Terraform","value":"devlogansible-vs-terraform","line":21,"column":0,"depth":2},"terraform-architecture":{"type":"header","text":"Terraform Architecture","value":"terraform-architecture","line":27,"column":0,"depth":2},"core":{"type":"header","text":"Core","value":"core","line":31,"column":0,"depth":3},"providers":{"type":"header","text":"Providers","value":"providers","line":39,"column":0,"depth":3},"example-config-files":{"type":"header","text":"Example config files","value":"example-config-files","line":45,"column":0,"depth":2},"terraform-commands-for-different-stages":{"type":"header","text":"Terraform commands for different stages","value":"terraform-commands-for-different-stages","line":53,"column":0,"depth":2},"providers-1":{"type":"header","text":"Providers","value":"providers-1","line":60,"column":0,"depth":2},"resources":{"type":"header","text":"Resources","value":"resources","line":72,"column":0,"depth":2},"data-sources":{"type":"header","text":"Data Sources","value":"data-sources","line":80,"column":0,"depth":2},"terraform-commands":{"type":"header","text":"Terraform Commands","value":"terraform-commands","line":86,"column":0,"depth":2},"examples":{"type":"header","text":"Examples","value":"examples","line":93,"column":0,"depth":2},"creating-an-ec2-instance-with-terraform":{"type":"header","text":"Creating an EC2 instance with Terraform","value":"creating-an-ec2-instance-with-terraform","line":95,"column":0,"depth":3},"changing-resources":{"type":"header","text":"Changing resources","value":"changing-resources","line":128,"column":0,"depth":3},"removingdestroying-resources":{"type":"header","text":"Removing/Destroying resources","value":"removingdestroying-resources","line":171,"column":0,"depth":3},"state":{"type":"header","text":"State","value":"state","line":176,"column":0,"depth":2},"output":{"type":"header","text":"Output","value":"output","line":191,"column":0,"depth":2},"variables":{"type":"header","text":"Variables","value":"variables","line":205,"column":0,"depth":2},"default-values":{"type":"header","text":"Default values","value":"default-values","line":236,"column":0,"depth":3},"type-constraints":{"type":"header","text":"Type constraints","value":"type-constraints","line":240,"column":0,"depth":3},"environment-variables":{"type":"header","text":"Environment Variables","value":"environment-variables","line":290,"column":0,"depth":2},"tf-environment-variable":{"type":"header","text":"TF Environment Variable","value":"tf-environment-variable","line":301,"column":0,"depth":3},"provisioners":{"type":"header","text":"Provisioners","value":"provisioners","line":323,"column":0,"depth":2},"null-resource":{"type":"header","text":"Null resource","value":"null-resource","line":327,"column":0,"depth":3},"connection-attribute":{"type":"header","text":"Connection attribute","value":"connection-attribute","line":339,"column":0,"depth":3},"remote-exec-provisioner":{"type":"header","text":"remote-exec provisioner","value":"remote-exec-provisioner","line":343,"column":0,"depth":3},"local-exec-provisioner":{"type":"header","text":"local-exec provisioner","value":"local-exec-provisioner","line":403,"column":0,"depth":3},"resources-1":{"type":"header","text":"Resources","value":"resources-1","line":409,"column":0,"depth":2}},"children":[],"parent":"9gtn7g40cvqui0sifl1s7t5","data":{}},"body":"\u003ch1 id=\"terraform\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#terraform\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTerraform\u003c/h1\u003e\n\u003cp\u003eTerraform is an open source infrastructure as code (\u003ca href=\"/notes/ogswllwu9h5oqeiteyhrtd6\"\u003eIaC\u003c/a\u003e) software tool that allows DevOps engineers to programmatically provision the physical resources an application requires to run. To create and configure infrastructure . NOT for installing stuff on the server, just for provisioning.\u003c/p\u003e\n\u003cp\u003eIt is a universal \u003ca href=\"/notes/ogswllwu9h5oqeiteyhrtd6\"\u003eIaC\u003c/a\u003e tool, works with different cloud providers and technologies.\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eIaC\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/ogswllwu9h5oqeiteyhrtd6\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003cp\u003eInfrastructure as code is an IT practice that manages an application's underlying IT infrastructure through programming. This approach to resource allocation allows developers to logically manage, monitor and provision resources -- as opposed to requiring that an operations team manually configure each required resource.\u003c/p\u003e\n\u003cp\u003eManaging infrastructure (servers, network, etc) through definition files rather than manual configuration. Much like \u003ca href=\"/notes/xuy2qlaaas5gxkbjpuierrr\"\u003eConfiguration Management\u003c/a\u003e, this enables automation, consistency, and is self-documenting.\u003c/p\u003e\n\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003cp\u003eIt uses declarative syntax(as opposed to imperative syntax) to define what the end result looks like and it will figure out how to provision the infrastructure.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIt is also helps in automating the infrastructure as it changes over time.\u003c/li\u003e\n\u003cli\u003eTo replicate the same infrastructure in different environments(Dev, Staging, Production)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUsing Terraform, your infrastructure is idempotent. You don't need to remember the current state, you only define your desired state. Since, you use declarative syntax, you don't define the steps like you would if you were using imperative syntax.\u003c/p\u003e\n\u003ch2 id=\"ansible-vs-terraform\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#ansible-vs-terraform\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003e\u003ca href=\"/notes/mwyyxjbpi0gztjd00f39biv\"\u003eAnsible\u003c/a\u003e VS Terraform\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTerraform is mainly an infrastructure provisioning tool.\u003c/li\u003e\n\u003cli\u003eAnsible is mainly used for configuring infrastructure.\u003c/li\u003e\n\u003cli\u003eIts a common practice to combine both to get the best of both.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"terraform-architecture\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#terraform-architecture\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTerraform Architecture\u003c/h2\u003e\n\u003cp\u003eIt has 2 components:\u003c/p\u003e\n\u003ch3 id=\"core\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#core\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eCore\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eTakes 2 input sources\n\u003cul\u003e\n\u003cli\u003eTerraform Config\u003c/li\u003e\n\u003cli\u003eState(current state of the infrastructure)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCore takes the input from the config and state and compares what needs to be changed and what is already there as per the config and state.\u003c/li\u003e\n\u003cli\u003eIt essentially \u003cstrong\u003ecreates the execution plan\u003c/strong\u003e that the providers use.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"providers\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#providers\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eProviders\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eThis can be providers for the specifc technology(AWS, GCP, Azure, OpenStack, other \u003ca href=\"/notes/au5c3uq0jd84a2tg9oe25ll\"\u003eIaaS\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eIt can also has providers for higher level technologies(\u003ca href=\"/notes/gbeh61d6hvbmxxy63chp81b\"\u003eKubernetes\u003c/a\u003e, other \u003ca title=\"Private\" style=\"color: brown\" href=\"https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html\" target=\"_blank\"\u003edevlog.PaaS (Private)\u003c/a\u003e or even \u003ca title=\"Private\" style=\"color: brown\" href=\"https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html\" target=\"_blank\"\u003edevlog.SaaS (Private)\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eIt has over 100 providers and over 1000 resources.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"example-config-files\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#example-config-files\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eExample config files\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"https://res.cloudinary.com/zubayr/image/upload/v1655346903/wiki/lazrvzt8omhhkplp3xwt.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://res.cloudinary.com/zubayr/image/upload/v1655346973/wiki/tcxkbpv4dyrx9yjtnufu.png\"\u003e\u003c/p\u003e\n\u003cp\u003eWe only define a few attributes in the configuration file, the rest or defaults are handled by terraform. Auto-generated.\u003c/p\u003e\n\u003ch2 id=\"terraform-commands-for-different-stages\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#terraform-commands-for-different-stages\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTerraform commands for different stages\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003erefresh\u003c/code\u003e - query infra provider to get current state.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eplan\u003c/code\u003e - create an execution plan, just preview no real changes.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eapply\u003c/code\u003e - executes the plan(it does all the above steps, like refresh and plan and then apply).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edestroy\u003c/code\u003e - destroys the resources/infrastructure in the right order, does cleaning up of the resources. Reverting. It works similar to \u003ccode\u003eapply\u003c/code\u003e, it checks the state and makes a plan for what needs to be done.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"providers-1\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#providers-1\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eProviders\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eThey're basically a piece of code that knows how to talk to a specific technology. To connect to it and start using. Interact.\u003c/li\u003e\n\u003cli\u003eExpose resources for specific technology(AWS, GCP, Azure, OpenStack, other \u003ca href=\"/notes/au5c3uq0jd84a2tg9oe25ll\"\u003eIaaS\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eResponsible for understanding API of that platform.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://registry.terraform.io/browse/providers\"\u003eBrowse Providers | Terraform Registry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eProviders don't come with installation of terraform, they need to be installed separately.\u003c/li\u003e\n\u003cli\u003eOnce provider is installed using the \u003ccode\u003eterraform init\u003c/code\u003e command, the complete API of that provider is available.\u003c/li\u003e\n\u003cli\u003eYou get 2 components from the Providers\n\u003cul\u003e\n\u003cli\u003eResources\u003c/li\u003e\n\u003cli\u003eData Sources\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"resources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#resources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eResources\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eYou can use the \u003ccode\u003eresource\u003c/code\u003e keyword in your \u003ccode\u003e.tf\u003c/code\u003e file using the resource's name.\u003c/li\u003e\n\u003cli\u003eThe name of a resource follows the convention of \u003ccode\u003e\u0026#x3C;provider\u003e_\u0026#x3C;resource\u003e\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eYou can assign the resource to a variable by providing a variable name right after the resource name.\u003c/li\u003e\n\u003cli\u003eEach resource block describes one or more infrastructure objects. As referred to as \"attributes\" or \"parameters\".\u003c/li\u003e\n\u003cli\u003eWhen you're creating a resource for another resource that doesn't yet exist, you can reference the object.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"data-sources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#data-sources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eData Sources\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAllows data to be fetched for use in the \u003ccode\u003e.tf\u003c/code\u003e files.\u003c/li\u003e\n\u003cli\u003eQuery existing resources/components.\u003c/li\u003e\n\u003cli\u003eIt follows the same convention as the resource names.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"terraform-commands\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#terraform-commands\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTerraform Commands\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eterraform init\u003c/code\u003e - initialize the working directory. Installs the providers defined in the config file.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform apply\u003c/code\u003e - apply the changes using the configuration file in the working directory.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform apply -auto-approve\u003c/code\u003e - to skip the approve prompt.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform destroy\u003c/code\u003e - if \u003ccode\u003e-target\u003c/code\u003e is not specified, it'll destroy all of the resources defined in the configuration file.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"examples\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#examples\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eExamples\u003c/h2\u003e\n\u003ch3 id=\"creating-an-ec2-instance-with-terraform\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#creating-an-ec2-instance-with-terraform\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eCreating an EC2 instance with Terraform\u003c/h3\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003eprovider \u003cspan class=\"token string\"\u003e\"aws\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  region = \u003cspan class=\"token string\"\u003e\"us-east-1\"\u003c/span\u003e\n  access_key = \u003cspan class=\"token string\"\u003e\"AKIAJX7X7X7X7X7X7X7X\"\u003c/span\u003e\n  secret_key = \u003cspan class=\"token string\"\u003e\"secret\"\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// don't hard code the above values use Environment variables\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  cidr_block = \u003cspan class=\"token string\"\u003e\"10.0.0.0/16\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnet\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test-subnet-1\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = aws_vpc.test_vpc.id\n  cidr_block = \u003cspan class=\"token string\"\u003e\"10.0.10.0/24\"\u003c/span\u003e\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// if you wanted to create a subnet for an existing vpc, you could hard code the ID of your vpc OR use data sources\u003c/span\u003e\n\ndata \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"existing_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e//  use filter or attributes to filter through of your existing vpc/resource\u003c/span\u003e\n  default = \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnet\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test-subnet-2\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = data.existing_vpc.id\n  cidr_block = \u003cspan class=\"token string\"\u003e\"172.31.48.0/20\"\u003c/span\u003e\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"changing-resources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#changing-resources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eChanging resources\u003c/h3\u003e\n\u003cp\u003eAdding names using \u003ccode\u003etags:\u003c/code\u003e keyword and using the reserved \u003ccode\u003eName\u003c/code\u003e attribute for defining a name.\nTo remove something, you'd simply remove it from the config file.\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003eprovider \u003cspan class=\"token string\"\u003e\"aws\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  region = \u003cspan class=\"token string\"\u003e\"us-east-1\"\u003c/span\u003e\n  access_key = \u003cspan class=\"token string\"\u003e\"AKIAJX7X7X7X7X7X7X7X\"\u003c/span\u003e\n  secret_key = \u003cspan class=\"token string\"\u003e\"secret\"\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// don't hard code the above values\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  cidr_block = \u003cspan class=\"token string\"\u003e\"10.0.0.0/16\"\u003c/span\u003e\n  tags = \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"development-vpc\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    vpc_env\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"dev\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnet\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test-subnet-1\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = aws_vpc.test_vpc.id\n  cidr_block = \u003cspan class=\"token string\"\u003e\"10.0.10.0/24\"\u003c/span\u003e\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n    tags = \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"development-subnet\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// if you wanted to create a subnet for an existing vpc, you could hard code the ID of your vpc OR use data sources\u003c/span\u003e\n\ndata \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"existing_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e//  use filter or attributes to filter through of your existing vpc/resource\u003c/span\u003e\n  default = \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnet\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test-subnet-2\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = data.existing_vpc.id\n  cidr_block = \u003cspan class=\"token string\"\u003e\"172.31.48.0/20\"\u003c/span\u003e\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"removingdestroying-resources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#removingdestroying-resources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eRemoving/Destroying resources\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eRemove the resource from Terraform config file and \u003ccode\u003eterraform apply\u003c/code\u003e. (Recommended)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform destroy -target resource_type.resource_name\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"state\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#state\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eState\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eterraform.tfstate\u003c/code\u003e - it is a \u003ccode\u003ejson\u003c/code\u003e file where Terraform stores the state of your managed infrastructure. It generates this file on your first \u003ccode\u003eterraform apply\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eterraform.tfstate.backup\u003c/code\u003e is the file that is created to store the backup of the previous state.\u003c/p\u003e\n\u003cp\u003eNeither of these files should be updated manually and must be updated as a result of executing \u003ccode\u003eterraform\u003c/code\u003e commands.\u003c/p\u003e\n\u003cp\u003eTerraform has commands to access the information in the state file.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eterraform state\u003c/code\u003e - list all subcommands of \u003ccode\u003estate\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform state list\u003c/code\u003e - list all resources in the state.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform state mv\u003c/code\u003e - move an item in the state.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eterraform state show\u003c/code\u003e - show a resource in the state. Useful for checking the values of the attributes that were autogenerated by Terraform.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"output\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#output\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eOutput\u003c/h2\u003e\n\u003cp\u003eWe can define what value we want Terraform to spit at the end of applying of the configuration from the resources. Output values are like function's return values.\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003eoutput \u003cspan class=\"token string\"\u003e\"dev-vpc-id\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  value = aws_vpc.development_vpc.id\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\noutput \u003cspan class=\"token string\"\u003e\"dev-subnet-id\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  value = aws_subnet.dev-subnet\u003cspan class=\"token number\"\u003e-1\u003c/span\u003e.id\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"variables\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#variables\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eVariables\u003c/h2\u003e\n\u003cp\u003eYou use variables inside of the configuration file. variables = input variables. If you don't want to hard code values you can pass them as parameters. Define and reference it. Input variables are like function arguments. They're defined using \u003ccode\u003evariable\u003c/code\u003e keyword. Makes it easier to replicate, parameterize, and reuse the same configuration over different environments. You'd have different \u003ccode\u003e.tfvars\u003c/code\u003e files for different environments.\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003evariable \u003cspan class=\"token string\"\u003e\"subnet_cidr_block\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  description = \u003cspan class=\"token string\"\u003e\"CIDR block for the subnet\"\u003c/span\u003e\n  default = \u003cspan class=\"token string\"\u003e\"10.0.30.0/24\"\u003c/span\u003e\n  type = string\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"development_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = aws_vpc.test_vpc.id\n  cidr_block = var.subnet_cidr_block\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n  tags\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"subnet-1-dev\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere are three ways to pass values to input variables.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ePrompt when \u003ccode\u003eterraform apply\u003c/code\u003e is run.\u003c/li\u003e\n\u003cli\u003eDefine the value when running apply command\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eterraform apply -var \"subnet_cidr_block=10.0.30.0/24\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eUse a \u003ccode\u003e.tfvars\u003c/code\u003e to pass the values from a file. (Recommended)\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eterraform.tfvars\u003c/code\u003e - this is a file that contains the (keys)values for the variables. (If you don't pass a file name, it'll look for this file)\u003c/li\u003e\n\u003cli\u003eUse the \u003ccode\u003e-var-file\u003c/code\u003e flag to pass the file name.\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eterraform apply -var-file terraform-dev.tfvars\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"default-values\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#default-values\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eDefault values\u003c/h3\u003e\n\u003cp\u003eDefault value will kick in if terraform cannot find the value in the \u003ccode\u003e.tfvars\u003c/code\u003e file or as a command line argument. A default value makes the variable optional.\u003c/p\u003e\n\u003ch3 id=\"type-constraints\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#type-constraints\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eType constraints\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003etype\u003c/code\u003e specifies what value types the variable can accept.\u003c/p\u003e\n\u003cp\u003eUsing \u003ccode\u003elist\u003c/code\u003e:\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003evariable \u003cspan class=\"token string\"\u003e\"cidr_blocks\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  description = \u003cspan class=\"token string\"\u003e\"CIDR blocks list\"\u003c/span\u003e\n  type = list(string)\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnut\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"dev-subnet-1\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = aws_vpc.test_vpc.id\n  cidr_block = var.cidr_blocks\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  availability_zone = \u003cspan class=\"token string\"\u003e\"us-east-1a\"\u003c/span\u003e\n  tags\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"subnet-1-dev\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can also use objects or lists of objects. You can also validate the type of the value for the objects as well.\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token comment\"\u003e// terraform-dev.tfvars\u003c/span\u003e\n\ncidr_blocks = \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecidr_block = \u003cspan class=\"token string\"\u003e\"10.0.10.0/16\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name = \u003cspan class=\"token string\"\u003e\"dev_vpc\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ecidr_block = \u003cspan class=\"token string\"\u003e\"10.0.20.0/24, name = \"\u003c/span\u003edev_subnet\"\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003evariable \u003cspan class=\"token string\"\u003e\"cidr_blocks\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  description = \u003cspan class=\"token string\"\u003e\"CIDR blocks list and Name tag\"\u003c/span\u003e\n  type = list(object(\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    cidr_block\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e string\n    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e string\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e))\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_vpc\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"test_vpc\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  cidr_block = var.cidr_blocks\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e.cidr_block\n  tags = \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e var.cidr_blocks\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e.name\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"environment-variables\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#environment-variables\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eEnvironment Variables\u003c/h2\u003e\n\u003cp\u003eEnvironment variables are defined by the providers for you to use.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUse \u003ccode\u003eexport\u003c/code\u003e to set the environment variable, it will be available only for the current shell session.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eexport AWS_SECRET_ACCESS_KEY=\u0026#x3C;secret_access_key\u003e\u003c/code\u003e\n\u003ccode\u003eexport AWS_ACCESS_KEY_ID=\u0026#x3C;access_key_id\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSet the environment variable in the \u003ccode\u003e~/.aws/credentials\u003c/code\u003e to be available globally, you may also use \u003ccode\u003eaws configure\u003c/code\u003e to set the credentials.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"tf-environment-variable\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#tf-environment-variable\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTF Environment Variable\u003c/h3\u003e\n\u003cp\u003eDefine your own custom variables and use \u003ccode\u003e.tf_var\u003c/code\u003e to pass them to the Terraform configuration as global environment variables.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDefine the variable - \u003ccode\u003eexport TF_VAR_my_custom_variable=\"my_custom_value\"\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eTo use it, reference it without the \u003ccode\u003eTF_VAR_\u003c/code\u003e prefix.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003evariable \u003cspan class=\"token string\"\u003e\"my_custom_variable\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nresource \u003cspan class=\"token string\"\u003e\"aws_subnut\"\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"dev-subnet-1\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  vpc_id = aws_vpc.test_vpc.id\n  cidr_block = var.cidr_blocks\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  availability_zone = var.my_custom_variable\n  tags\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    Name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"subnet-1-dev\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eTerraform in AWS\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/bhvn90wgxfjtejvv2t10lvx\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003cp\u003eIn this lab, we'll do:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eProvision an \u003ca href=\"/notes/1h5mmmv2b68di6siwa31jvh\"\u003eAWS EC2\u003c/a\u003e instance on AWS.\u003c/li\u003e\n\u003cli\u003eRun a simple \u003ca href=\"/notes/7jdwsm0maamijwmsnzebbwf\"\u003eNginx\u003c/a\u003e \u003ca href=\"/notes/wf37vjntme0oklsx52ycrn4\"\u003eDocker\u003c/a\u003e container on it.\u003c/li\u003e\n\u003cli\u003eWe'll do this on AWS infrastructure using Terraform (obviously).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"steps\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#steps\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eSteps\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eCreate custom VPC\u003c/li\u003e\n\u003cli\u003eCreate custom Subnet\u003c/li\u003e\n\u003cli\u003eCreate Route table and Internet Gateway.\n\u003cul\u003e\n\u003cli\u003eTo connect the VPC to the internet.\u003c/li\u003e\n\u003cli\u003eAllow traffic to and from VPC.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDeploy EC2 instance on the Subnet.\u003c/li\u003e\n\u003cli\u003eDeploy ngnix Docker container.\u003c/li\u003e\n\u003cli\u003eCreate Security Group(Firewall), opening ports.\n\u003cul\u003e\n\u003cli\u003eIn order to access the Web Application.\u003c/li\u003e\n\u003cli\u003eAnd also to SSH into that EC2 server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"create-vpc-and-subnet\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#create-vpc-and-subnet\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eCreate VPC and Subnet\u003c/h2\u003e\n\u003cpre class=\"language-terraform\"\u003e\u003ccode class=\"language-terraform\"\u003eprovider \"aws\" {\n  region = \"eu-central-1\"\n}\n\nvariable vpc_cidr_block {}\nvariable subnet_1_cidr_block {}\nvariable avail_zone {}\nvariable env_prefix {}\nvariable instance_type {}\nvariable ssh_key {}\nvariable my_ip {}\n\ndata \"aws_ami\" \"amazon-linux-image\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"name\"\n    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n}\n\noutput \"ami_id\" {\n  value = data.aws_ami.amazon-linux-image.id\n}\n\nresource \"aws_vpc\" \"myapp-vpc\" {\n  cidr_block = var.vpc_cidr_block\n  tags = {\n      Name = \"${var.env_prefix}-vpc\"\n  }\n\n  # Route table is auto-generated for your VPC by AWS\n  # Default Network ACL - firewall configuration (applied to subnet in that VPC)\n}\n\nresource \"aws_subnet\" \"myapp-subnet-1\" {\n  vpc_id = aws_vpc.myapp-vpc.id\n  cidr_block = var.subnet_1_cidr_block\n  availability_zone = var.avail_zone\n  tags = {\n      Name = \"${var.env_prefix}-subnet-1\"\n  }\n}\n\nresource \"aws_security_group\" \"myapp-sg\" {\n# BTW you can also just use the default SG that was generated when VPC was created\n# resource \"aws_default_security_group\" \"default-sg\" { # you really only need to change this, rest remains the same\n  name   = \"myapp-sg\"\n  vpc_id = aws_vpc.myapp-vpc.id\n\n# Defining traffic rules for firewall\n  ingress {\n    from_port   = 22\n    to_port     = 22 # you can even set a range of ports but we only need 22\n    protocol    = \"tcp\"\n    cidr_blocks = [var.my_ip]\n  }\n\n  ingress {\n    from_port   = 8080\n    to_port     = 8080\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    # allow any traffic to leave server\n    from_port       = 0\n    to_port         = 0\n    protocol        = \"-1\" # any protocols\n    cidr_blocks     = [\"0.0.0.0/0\"]\n    prefix_list_ids = []\n  }\n\n  tags = {\n    Name = \"${var.env_prefix}-sg\"\n  }\n}\n\nresource \"aws_internet_gateway\" \"myapp-igw\" {\n\tvpc_id = aws_vpc.myapp-vpc.id\n\n    # Think of it as a virtual modem\n    # Even though it has to be created before Route table, you don't necessarily have to put this block before the route table block.\n    # Terraform knows in which sequence it needs to create components.\n    tags = {\n     Name = \"${var.env_prefix}-internet-gateway\"\n   }\n}\n\nresource \"aws_route_table\" \"myapp-route-table\" {\n   vpc_id = aws_vpc.myapp-vpc.id\n\n    # Think of it as a virtual router inside your VPC\n    # Create a new Route table as it is a best practice(not going with the default that comes with VPC creation)\n    # default route, mapping VPC CIDR block to \"local\", created implicitly and cannot be specified.\n   route {\n     cidr_block = \"0.0.0.0/0\"\n     gateway_id = aws_internet_gateway.myapp-igw.id\n   }\n\n   # Route table basically routes traffic within your VPC  (local)\n   # You have to add an Internet Gateway to connect your VPC to the internet\n   # Check \"routes\" in your Route Table for 0.0.0.0/0 (destination) and there has to be an Internet Gateway(as target)\n\n   tags = {\n     Name = \"${var.env_prefix}-route-table\"\n   }\n }\n\n# Associate subnet with Route Table\n# All the resource that will be deployed in the subnet, all the traffic will be handled by the route table once the association has been made.\nresource \"aws_route_table_association\" \"a-rtb-subnet\" {\n  subnet_id      = aws_subnet.myapp-subnet-1.id\n  route_table_id = aws_route_table.myapp-route-table.id\n}\n\n# To use the default route table instead of creating a new one\n\n# resource \"aws_default_route_table\" \"main-rtb\" {\n#   # get default route table id by terraform state show aws_vpc.myapp-vpc(it has to exist) to list all attribute it has\n#   default_route_table_id = aws_vpc.myapp-vpc.default_route_table_id\n#   route {\n#      cidr_block = \"0.0.0.0/0\"\n#      gateway_id = aws_internet_gateway.myapp-igw.id\n#    }\n\n#   tags = {\n#      Name = \"${var.env_prefix}-main-rtb\"\n#    }\n\n# In this case, you don't need to add subnet association as \"main\" route tables as default subnet gets auto-assigned\n# }\n\n\n# automated key generation\nresource \"aws_key_pair\" \"ssh-key\" {\n  key_name   = \"myapp-key\"\n  # public_key = var.my_public_key\n  public_key = file(var.ssh_key) # this should exist locally - you should create it yourself.\n}\n\noutput \"server-ip\" {\n    value = aws_instance.myapp-server.public_ip\n}\n\nresource \"aws_instance\" \"myapp-server\" {\n  # required\n  ami                         = data.aws_ami.amazon-linux-image.id\n  instance_type               = var.instance_type\n\n  # create a public-private key sshing into the EC2 instance, don't forget to `chmod 400 ~/.ssh/.pem` after moving it to `~/.ssh` - this applies only when you manually create it\n\n  key_name                    = \"myapp-key\"\n\n  # optional\n  associate_public_ip_address = true\n  subnet_id                   = aws_subnet.myapp-subnet-1.id\n  vpc_security_group_ids      = [aws_security_group.myapp-sg.id]\n  availability_zone\t\t\t      = var.avail_zone\n\n  tags = {\n    Name = \"${var.env_prefix}-server\"\n  }\n\n  user_data = \u0026#x3C;\u0026#x3C;EOF\n                 #!/bin/bash\n                 apt-get update \u0026#x26;\u0026#x26; apt-get install -y docker-ce\n                 systemctl start docker\n                 usermod -aG docker ec2-user\n                 docker run -p 8080:8080 nginx\n              EOF\n}\n\nresource \"aws_instance\" \"myapp-server-two\" {\n  ami                         = data.aws_ami.amazon-linux-image.id\n  instance_type               = var.instance_type\n  key_name                    = \"myapp-key\"\n  associate_public_ip_address = true\n  subnet_id                   = aws_subnet.myapp-subnet-1.id\n  vpc_security_group_ids      = [aws_security_group.myapp-sg.id]\n  availability_zone\t\t\t      = var.avail_zone\n\n  tags = {\n    Name = \"${var.env_prefix}-server-two\"\n  }\n\n  # you can refer a bash file instead of writing it here\n\n  # doing the below changes will cause your EC2 instance to replaced(destroy and create)\n  # user_data = file(\"entry-script.sh\") # this file has to be located in your terraform dir\n  # Ideally, Terraform should only be used for initial infra setup/management, but for setting up applications and servers, you should probably use something like Ansible or Chef.\n  user_data = \u0026#x3C;\u0026#x3C;EOF\n                 #!/bin/bash\n                 apt-get update \u0026#x26;\u0026#x26; apt-get install -y docker-ce\n                 systemctl start docker\n                 usermod -aG docker ec2-user\n                 docker run -p 8080:8080 nginx\n              EOF\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch2 id=\"provisioners\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#provisioners\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eProvisioners\u003c/h2\u003e\n\u003cp\u003eProvisioners can be used to model specific actions on the local machine running the Terraform Core or on a remote machine to prepare servers or other infrastructure objects. But HashiCorp states in its documentation that they should be used as the last solution!\u003c/p\u003e\n\u003ch3 id=\"null-resource\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#null-resource\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eNull resource\u003c/h3\u003e\n\u003cp\u003eFrom the Terraform docs:\u003c/p\u003e\n\u003cp\u003eThe null provider is a rather-unusual provider that has constructs that intentionally do nothing. This may sound strange, and indeed these constructs do not need to be used in most cases, but they can be useful in various situations to help orchestrate tricky behavior or work around limitations.\u003c/p\u003e\n\u003cp\u003eThe documentation of each feature of this provider, accessible via the navigation, gives examples of situations where these constructs may prove useful.\u003c/p\u003e\n\u003cp\u003eUsage of the null provider can make a Terraform configuration harder to understand. While it can be useful in certain cases, it should be applied with care and other solutions preferred when available.\u003c/p\u003e\n\u003cp\u003eThe Terraform null_resourceis commonly used to run scripts on a specified trigger.\u003c/p\u003e\n\u003ch3 id=\"connection-attribute\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#connection-attribute\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eConnection attribute\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eremote-exec\u003c/code\u003e provisioners require connection credentials to function, even though \u003ccode\u003eremote-exec\u003c/code\u003e might be defined in a resource block that is a server, it doesn't connect to it unless explicity defined.\u003c/p\u003e\n\u003ch3 id=\"remote-exec-provisioner\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#remote-exec-provisioner\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003e\u003ccode\u003eremote-exec\u003c/code\u003e provisioner\u003c/h3\u003e\n\u003cp\u003eThis provisioner invokes a script on the newly created resource. it’s similar to connecting to the resource and running a bash or a command in the terminal.\u003c/p\u003e\n\u003cp\u003eIt can be used inside the Terraform resource object and in that case it will be invoked once the resource is created, or it can be used inside a null resource which is my prefered approche as it separates this non terraform behavior from the real terraform behavior.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInvokes script on a remote resource after it is created\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003einline\u003c/code\u003e - list of commands\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003escript\u003c/code\u003e - path to script\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-terraform\"\u003e\u003ccode class=\"language-terraform\"\u003eresource \"null_resource\" \"configure-vm\" {\n\n  connection {\n      type = \"ssh\"\n      user = var.username\n      host = var.ip_address\n      private_key = var.tls_private_key\n    }\n\n  ## Copy files to VM :\n  provisioner \"file\" {\n    source = \"/Users/zakariaelbazi/Documents/GitHub/zackk8s/kubernetes\" #TODO move to variables.\n    destination = \"/home/${var.username}\"\n  }\n\n  ## install \u0026#x26; start minikube\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sudo chmod +x /home/${var.username}/kubernetes/install_minikube.sh\",\n      \"sh /home/${var.username}/kubernetes/install_minikube.sh\",\n      \"./minikube start --driver=docker\"\n    ]\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote that you can not pass any arguments to the script or command, so the best way is to use file provisioner to copy the files to the resources and then invoke them with the remote-exec provisioner like I did above for my script that installs minikube on the azure-vm.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAn other thing to pay attention to is that by default, provisioners that fail will also cause the Terraform apply to fail. To avoid that, the on_failure can be used.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre class=\"language-terraform\"\u003e\u003ccode class=\"language-terraform\"\u003eresource \"null_resource\" \"configure-vm\" {\n    .........\n    ..........\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"sudo chmod +x /home/${var.username}/kubernetes/install_minikube.sh\",\n      \"sh /home/${var.username}/kubernetes/install_minikube.sh\",\n      \"./minikube start --driver=docker\"\n    ]\n    on_failure = continue #or fail\n\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn this example, I am using inline which is a series of command, the on_failure will apply only to the final command in the list !\u003c/p\u003e\n\u003ch3 id=\"local-exec-provisioner\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#local-exec-provisioner\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003e\u003ccode\u003elocal-exec\u003c/code\u003e provisioner\u003c/h3\u003e\n\u003cp\u003eTechnically, this one is very similar to the one before in terms of behavior or use but it works in the local machine ruining Terraform. It invokes a script or a command on local once the resource it’s declared in is created.\u003c/p\u003e\n\u003cp\u003eIt’s the only provisioner that doesn’t need any ssh or winrm connection details as it runs locally.\u003c/p\u003e\n\u003ch2 id=\"resources-1\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#resources-1\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eResources\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jhooq.com/terraform-provisioner/\"\u003eWhat is terraform provisioner? | Jhooq\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://awstip.com/all-you-need-to-know-about-terraform-provisioners-and-why-you-should-avoid-them-22b5ef8d2db2\"\u003eAll you need to know about Terraform provisioners and why you should avoid them. | AWS Tip\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.trendmicro.com/ru_ru/devops/22/c/terraform-tutorial-drift-detection-strategies.html\"\u003eTerraform Tutorial: Drift Detection Strategies\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/522ww47pqvt6y0yj8zparmy\"\u003eDevOps\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/kxbhnz5oxpmort5y94uvqc9\"\u003ePacker\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/e7pods321uz4fxgzzdhf002\"\u003eBoto\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/5eybx5vd339tjnkglx8igde\"\u003eDevops Interview Questions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/i5wu7j4cvg8tzfyzkawbsjt\"\u003eEc2 Server Status Check using Boto3\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"3nfl4nvv516muyzozhcwrw8","title":"/root","desc":"","updated":1655559901157,"created":1637610830605,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"581715455a6f0f7a699209e8521b4acf","links":[{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"archive.about","alias":"my","position":{"start":{"line":4,"column":9,"offset":37},"end":{"line":4,"column":29,"offset":57},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"archive.about"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"tags.areas","alias":"#areas","position":{"start":{"line":20,"column":111,"offset":1051},"end":{"line":20,"column":117,"offset":1057},"indent":[]},"xvault":false,"to":{"fname":"tags.areas"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"tags.areas","alias":"#areas","position":{"start":{"line":21,"column":3,"offset":1198},"end":{"line":21,"column":9,"offset":1204},"indent":[]},"xvault":false,"to":{"fname":"tags.areas"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"swipes","alias":"swipes","position":{"start":{"line":27,"column":3,"offset":1724},"end":{"line":27,"column":13,"offset":1734},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"swipes"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"swipes.quotes","alias":"quotes","position":{"start":{"line":27,"column":48,"offset":1769},"end":{"line":27,"column":72,"offset":1793},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"swipes.quotes"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"swipes.excerpts","alias":"excerpts","position":{"start":{"line":27,"column":74,"offset":1795},"end":{"line":27,"column":102,"offset":1823},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"swipes.excerpts"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"swipes.sayings","alias":"sayings","position":{"start":{"line":27,"column":104,"offset":1825},"end":{"line":27,"column":130,"offset":1851},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"swipes.sayings"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"swipes.phrases","alias":"phrases","position":{"start":{"line":27,"column":132,"offset":1853},"end":{"line":27,"column":158,"offset":1879},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"swipes.phrases"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"resources.people","alias":"others","position":{"start":{"line":27,"column":214,"offset":1935},"end":{"line":27,"column":241,"offset":1962},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"resources.people"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"inbox.webmark","alias":"webmark","position":{"start":{"line":31,"column":235,"offset":2463},"end":{"line":31,"column":260,"offset":2488},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"inbox.webmark"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"slipbox.Ontology","alias":"slipbox.Ontology","position":{"start":{"line":55,"column":3,"offset":3735},"end":{"line":55,"column":23,"offset":3755},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"slipbox.Ontology"}},{"type":"wiki","from":{"fname":"root","id":"3nfl4nvv516muyzozhcwrw8","vaultName":"Dendron"},"value":"archive.about","alias":"About me","position":{"start":{"line":60,"column":3,"offset":3963},"end":{"line":60,"column":29,"offset":3989},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"archive.about"}}],"anchors":{"welcome-to-noetic-noggin":{"type":"header","text":"Welcome to Noetic Noggin","value":"welcome-to-noetic-noggin","line":8,"column":0,"depth":1},"principles":{"type":"header","text":"Principles","value":"principles","line":18,"column":0,"depth":2},"all-notes-should-be-relative-to-me":{"type":"header","text":"All notes should be relative to me.","value":"all-notes-should-be-relative-to-me","line":20,"column":0,"depth":3},"gotta-capture-em-all":{"type":"header","text":"Gotta capture 'em all","value":"gotta-capture-em-all","line":30,"column":0,"depth":3},"dont-force-evolution":{"type":"header","text":"Don't force evolution","value":"dont-force-evolution","line":40,"column":0,"depth":3},"noise--signal":{"type":"header","text":"Noise \u0026 Signal","value":"noise--signal","line":45,"column":0,"depth":3},"why-do-any-of-this":{"type":"header","text":"Why do any of this?","value":"why-do-any-of-this","line":50,"column":0,"depth":3},"structure-of-this-wiki":{"type":"header","text":"Structure of this wiki","value":"structure-of-this-wiki","line":59,"column":0,"depth":2},"quicklinks":{"type":"header","text":"Quicklinks","value":"quicklinks","line":64,"column":0,"depth":2}},"children":["0yay2om15bsg2li2p6qgux7","05c4nnjqa92zx11ld6o0ytn","9gtn7g40cvqui0sifl1s7t5","ftbd1hknsd3ocd7jao26tn3","a1kmkdbpclaz5p6sykaw6kc","z121gkmqfo09m8r7jgnpfgn","gkqrr7xbt18xhi93dmjrwzj","ja2x4lrgejr9o9wvit0bd0d","luv39odkfibx3wdosvigwvy","vtvk3bi6o72w58oima9xzf3","yy652kvqrkfn9ipk07m40h4"],"parent":null,"data":{},"body":"\n# Welcome to Noetic Noggin\n\nThis is [[my|archive.about]] personal wiki and a commonplace book; notes by me, for me.\n\n🚧 Permanently under construction 🚧\n\n![](https://res.cloudinary.com/zubayr/image/upload/v1658499909/wiki/ajevkuyebljlxiblyst2.png)\n\nThis wiki was made possible with [dendron.so](https://dendron.so) and [obisidian.md](https://obsidian.md). Stored on [Github Repository](https://github.com/zubayrrr/dendron) and hosted on [Netlify](https://netlify.com) for free.\n\n## Principles\n\n### All notes should be relative to me.\n\n- All notes in principle are written for me; what I know about a subject, how I feel about a particular thing.\n- Opinions are fine as long as I feel strong epistemic confidence in the given opinion.\n- Don't over explain a note if it's not necessary, remember, these notes are for you and are relative to whatever knowledge you posses about the subject.\n- Read books and make an dedicated notes for them.\n- Listen podcasts but capture them inside a \"subject specific\" note or \"Map of Concept\" note or a note tagged #areas. Because making notes from podcasts can be tedious as they're not as well structured as books for consumption.(Whose merit is debatable.)\n- #areas are basically \"Map of Concept\" notes but I have recently come to the realization that its better to maintain them [Nikita Voloboev style](https://wiki.nikiv.dev/) but with heavy usage of transclusion and backlinking.\n  - \"Resources\" should be first processed and then mentioned inside the note, otherwise they should be left in inbox.\n\n### Gotta capture 'em all\n\n- Hog whatever information tickles your pickle([anything that gratifies one's intellectual curiosity](https://news.ycombinator.com/newsguidelines.html)).\n- [[swipes]] are interesting/useful bits of... [[quotes|swipes.quotes]], [[excerpts|swipes.excerpts]], [[sayings|swipes.sayings]], [[phrases|swipes.phrases]]. Essentially, ideas, opinions that are swiped off from [[others|resources.people]].\n- Make no distinction between \"your\" ideas and ideas of \"others\", because if you vibe with an idea; it's already yours.\n- But also remember \"If you've time to consume, you've time to produce.\".\n- Use [raindrop.io](https://raindrop.io) to manage your URL bookmarks.\n- If you need to bookmark a webpage or an article all together, use [MarkDownload](https://chrome.google.com/webstore/detail/markdownload-markdown-web/pcmpcfapbekmbjjkdalcgopdkipoggdi?hl=en-GB) to rip the entire page. Let's call it a [[webmark|inbox.webmark]]; it belong in the `/inbox`.\n- Similar process is employed for capturing tweets using [tweet-to-markdown](https://github.com/kbravh/tweet-to-markdown) and it also belongs in the `/inbox`.\n\n### Don't force evolution\n\n- Let your second brain evolve at it's own pace.\n- The structure should never be _too_ rigid because its meant to take form by itself.\n\n### Noise \u0026 Signal\n\n- While capturing ideas left and right is recommended, make sure you're not harming your periods of focus.\n- Have impenetrable focus periods (use Pomodoro method) where you only care about the work on hand and nothing else.\n\n### Why do any of this?\n\n- Because I can't remember everything - there's a lot of information around that interests me and there isn't enough working memory installed in me.\n- So, I make notes - to remember, to create, to meditate, to think.\n- A bodybuilder's portfolio is their body - my portfolio is my wiki.\n- Not only am I making - whatever I know - tangible by writing it down. I know exactly where to look if I ever forget something.\n- I am at the beginning of my learning adventures. When I look back at it, I will know where I came from and how my thoughts evolved over time.\n- Plus, its really fun to nerd out.\n\n## Structure of this wiki\n\n- [[slipbox.Ontology]] explains the structure of this wiki and the tags, backlinks used in it.\n- Dendron takes care of the structure and hierarchy(mostly), but I insist on using tags for backwards compatibility.\n\n## Quicklinks\n\n- [[About me|archive.about]]\n- [Github](https://github.com/zubayrrr)\n- [Twitter](https://twitter.com/zoobhalu)\n- [Blog](https://zubayrali.in)\n- [Guestbook](https://www.yourworldoftext.com/~zubayrali/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template","insertNote":{"initialValue":"templates"}},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Dendron"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableHandlebarTemplates":true,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableSmartRefs":true},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Noetic Noggin","description":"Personal Wiki / Digital Garden","author":"Zubayr Ali","twitter":"zoobhalu"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"siteUrl":"localhost:3000","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"mkwoo3ek4y6bnddpy1iteb9"},"buildId":"4oDSInv8WeDX6cVSprjyl","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>