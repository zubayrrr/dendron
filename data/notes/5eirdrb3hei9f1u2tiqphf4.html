<h1 id="join"><a aria-hidden="true" class="anchor-heading" href="#join"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>JOIN</h1>
<ul>
<li>Areas: <a href="/notes/93cp838qc8pnou1we4cbdjb">SQL</a></li>
</ul>
<h3 id="inner-join"><a aria-hidden="true" class="anchor-heading" href="#inner-join"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>INNER JOIN</h3>
<ul>
<li><code>INNER</code> can be optionally prepended to <a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">JOIN (Private)</a> as there are INNER and OUTER joins in SQL, whenever you type <code>JOIN</code> you're using an INNER JOIN by default.</li>
<li>joining <code>orders</code> table with <code>customers</code> table</li>
</ul>
<!-- end list -->
<pre><code>SELECT *
FROM orders
JOIN customers
</code></pre>
<p>To line up one table with the other the <a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">ON (Private)</a> keyword is used so that the records from one table matches with the other, <code>ON</code> is followed by a condition on <strong>how</strong> to join the tables</p>
<pre><code>SELECT *
FROM orders
--columns from orders table are displayed first since it is declared first
JOIN customers ON orders.customer_id = customers.customer_id
</code></pre>
<p>To display <code>customer_id</code> column, the column has to be selected from either the <code>orders</code> table or the <code>customers</code> table</p>
<pre><code>SELECT order_id, orders.customer_id, first_name, last_name
FROM orders
JOIN customers
        ON orders.customer_id = customers.customer_id
</code></pre>
<p>To avoid repetition and make code simpler(more readability), abbreviate table names</p>
<pre><code>SELECT order_id, o.customer_id, first_name, last_name
FROM orders o
JOIN customers c
        ON o.customer_id = c.customer_id
</code></pre>
<h3 id="example"><a aria-hidden="true" class="anchor-heading" href="#example"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Example</h3>
<pre><code>SELECT order_id, p.product_id, quantity, o.unit_price
FROM order_items o
JOIN products p
        ON o.product_id = p.product_id
</code></pre>
<hr>
<h3 id="joining-across-databases"><a aria-hidden="true" class="anchor-heading" href="#joining-across-databases"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Joining Across Databases</h3>
<p>Your query will be different depending on the current database.</p>
<pre><code>USE inventory;

SELECT *
FROM store.order_items oi
JOIN products p
        ON oi.product_id = p.product_id
</code></pre>
<h3 id="self-joins"><a aria-hidden="true" class="anchor-heading" href="#self-joins"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Self Joins</h3>
<p>Join a table with itself</p>
<pre><code>USE sql_hr;

SELECT
        e.employee_id,
        e.first_name,
        m.first_name AS manager
FROM employees e
JOIN employees m
        ON e.reports_to = m.employee_id
</code></pre>
<h3 id="joining-multiple-tables"><a aria-hidden="true" class="anchor-heading" href="#joining-multiple-tables"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Joining Multiple Tables</h3>
<pre><code>USE sql_invoicing;

SELECT
        p.date,
        p.invoice_id,
        p.amount,
        c.name,
        pm.name
FROM payments p
JOIN clients cs
        ON p.client_id = c.client_id
JOIN payment_methods pm
        ON p.payment_method = pm.payment_method_id
</code></pre>
<h3 id="compound-join-conditions"><a aria-hidden="true" class="anchor-heading" href="#compound-join-conditions"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Compound JOIN conditions</h3>
<p>When you have a table with composite primary key, you can join those tables with other tables such as:</p>
<pre><code>SELECT *
FROM order_items oi
JOIN order_item_notes oin
        ON oi.order_id = oin.order_id
        AND oi.product_id = oin.product_id
</code></pre>
<h3 id="implicit-join-syntax"><a aria-hidden="true" class="anchor-heading" href="#implicit-join-syntax"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Implicit JOIN syntax</h3>
<pre><code>SELECT *
FROM orders o
JOIN customers c
        ON o.customer_id = c.customer_id
</code></pre>
<p>The above query can be instead written as:</p>
<pre><code>SELECT *
FROM orders o, customers c
WHERE o.customer_id = c.customer_id
</code></pre>
<p>Using implicit JOIN syntax is discourged to avoid a "<a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">CROSS JOIN (Private)</a>", for example, if you removed the <a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">WHERE (Private)</a> clause from the above query, it would match every record on the <code>orders</code> table with every record on <code>customers</code> table.</p>
<hr>
<h3 id="outer-join"><a aria-hidden="true" class="anchor-heading" href="#outer-join"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>OUTER JOIN</h3>
<pre><code>SELECT
        c.customer_id,
        c.first_name,
        o.order_id
FROM customers c
JOIN orders o
        ON c.customer_id = o.customer_id
--the above condition will only return customers that have orders placed, for customers that don't have an order id nothing will be returned
ORDER BY c.customer_id
</code></pre>
<p>There are two types of OUTER JOINs in <a href="/notes/ypszfixe0p3s5k0inqs5g08">MySql</a></p>
<ul>
<li>LEFT JOIN</li>
<li>RIGHT JOIN</li>
</ul>
<p>When you use <code>LEFT JOIN</code> all the records from the left table(on the FROM clause) are returned whether the <code>ON</code> condition is true or not and this is vice versa for <code>RIGHT JOIN</code></p>
<p>The <code>OUTER</code> keyword is optional as long as you're specifying <code>RIGHT</code> or <code>LEFT</code></p>
<pre><code>SELECT
        c.customer_id,
        c.first_name,
        o.order_id
FROM customers c
LEFT JOIN orders o
        ON c.customer_id = o.customer_id
ORDER BY c.customer_id
</code></pre>
<h3 id="outer-join-between-multiple-tables"><a aria-hidden="true" class="anchor-heading" href="#outer-join-between-multiple-tables"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>OUTER JOIN between multiple tables</h3>
<pre><code>SELECT
        c.customer_id,
        c.first_name,
        o.order_id,
        sh.name AS shipper
FROM customers c
LEFT JOIN orders o
        ON c.customer_id = o.customer_id
LEFT JOIN shippers sh
        ON o.shipper_id = sh.shipper_id
ORDER BY c.customer_id
</code></pre>
<h3 id="exercise"><a aria-hidden="true" class="anchor-heading" href="#exercise"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Exercise</h3>
<pre><code>SELECT
    o.order_date,
    o.order_id,
    c.first_name,
    sh.name AS shipper,
    os.name AS status
FROM orders o
JOIN customers c
        ON o.customer_id = c.customer_id
--using INNER JOIN as the condition is true
LEFT JOIN order_statuses os
        ON o.status = os.order_status_id
LEFT JOIN shippers sh
        ON o.shipper_id = sh.shipper_id
</code></pre>
<h3 id="self-outer-join"><a aria-hidden="true" class="anchor-heading" href="#self-outer-join"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Self OUTER JOIN</h3>
<pre><code>USE sql_hr;

SELECT
        e.employee_id,
        e.first_name,
        m.first_name AS manager
FROM employees e
LEFT JOIN employees m
        ON e.reports_to = m.employee_id
</code></pre>